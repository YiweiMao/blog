---
toc: true
layout: post
description: "A summary of the core theory behind 6SV2.1 for atmospheric correction."
categories: ["atmospheric correction"]
title: "Introduction to 6SV2.1: A Radiative Transfer Model"
image: images/2020-06-14-6sv_files/6sv_vermote.png
badges: true
comments: true
hide: true
search_exclude: true
permalink: 6sv
---


# Introduction

In this blog post, I will cover the basics from the [6SV2.1 manual](http://6s.ltdri.org/pages/manual.html). 6S stands for " **S**econd **S**imulation of a **S**atellite **S**ignal in the **S**olar **S**pectrum" and the V stands for *vectorised* meaning the polarisation of light is taken to account. This radiative transfer (RT) code is used to correct for atmospheric absorption and scattering. It also enables[^1]:

- accurate simulations of satellite, aircraft, and UAV observations,
- accounts for elevated targets,
- models a realistic atmospheric with aerosols and other molecules,
- and use of Lambertian and anisotropic ground surfaces.

According to Vermote *et al.*, it is "one of the most widely used, rigorously validated, and heavily documented RT codes known in the scientific remote-sensing community." Version 1 of the 6S code appeared in 1997 and now in the new version 2.1 release in 2015, it uses the method of successive orders of scattering for more accurate approximations that were previously too computationally taxing on old hardware. There are also more configurable settings. The code is written in *Fortran* which is very common for scientific libraries where speed is of primary concern. A comparison with other radiative transfer codes can be found in Kotchenova[^2] (2008). The default *standard accuracy* settings will provide around 0.4--0.6% accuracy compared to standard benchmarks.

# Background





![](images/2020-06-14-6sv_files/6sv_vermote.png "Figure 1: Atmospheric absorption and scattering (Vermote 2006)."){:width="70%"}

# Asorption

The majority of atmospheric asorption ha
- water vapour H$_2$O
- ozone O$_3$
- oxygen O$_2$
- carbon dioxide CO$_2$
- methane CH$_4$
- nitrous oxide N$_2$O

## Exponential Band Models

### Broadening Effects

#### Lorentz Distribution
pressure broadened

#### Gaussian Distribution
doppler from maxwellian

#### Voigz Distribution
convolution

### Goody

### Malkmus
[Thermal Radiation Heat Transfer John R] pg 460


# Scattering

## Lambertian Surface
matte
not specular
he luminous intensity obeys Lambert's cosine law.

$$
\mathbf{L}\cdot \mathbf{\hat{n}} = \cos \alpha
$$

# Stokes Vector

$$ \mathbf{S} = (I,Q,U,V) $$

where $I$ is intensity, 

$$
I = \sqrt{Q^2 + U^2 + V^2}
$$


This is The Stokes parameters {\displaystyle I}I, {\displaystyle Q}Q, {\displaystyle U}U, and {\displaystyle V}V, provide an alternative description of the polarization state which is experimentally convenient because each parameter corresponds to a sum or difference of measurable intensities.





| Symbol | Meaning |
| -: | :- |
| $\rho*$ | Equivalent reflectance |
| $L$ | Measured radiance |
| $E_s$ | Solar flux at atmosphere top |
| $\theta_s$ | Sun zenith angle | 
| $\phi_s$ | Sun azimuth angle | 
| $\mu_s$ | $\cos(\theta_s)$ |
| $\theta_v$ | Viewing zenith angle | 
| $\phi_v$ | Viewing azimuth angle | 
| $\mu_v$ | $\cos(\theta_v)$ |
| $\tau$ | Optical thickness of atmosphere | 
| $\rho_t$ | Reflectance of target | 
| $E^{dir}_{sol}$ | Direct solar flux attentuated by atmosphere |
| | $\mu_s E_s \exp(-\tau/\mu_s)$ |
| $t_d(\theta_s)$ | Diffuse transmittance factor | 
| | $E^{dir}_{sol}(\theta_s) / (\mu_s E_s) $ | 
| $E^{dir}_{sol} $ | Diffuse solar irradiance | 
| $S$ | Spherical albedo of atmosphere | 
| $T(\theta_s)$ |  Total transmittance |
|  | $\exp(-\tau/\mu_s) + t_d(\theta_s)$ |
| $\exp(-\tau/\mu_v)$ |  Direct and diffuse solar radiance reflected by surface transmitted to sensor | 
| $\Delta \omega$ |  Field of view angular width | 
| $\rho_a(\theta_s,\theta_v,\phi_s,\phi_v) | Intrinsic atmospheric radiance | 
| $t_d'(\theta_v)$ | Atmospheric diffuse transmittance (enviro reflected then scattered into sensor) |

Assuming surface reflectance is Lambertian
$$
\rho*(\theta_s,\theta_v,\phi_s,\phi_v)  = \rho_a(\theta_s,\theta_v,\phi_s,\phi_v) + \frac{T(\theta_s)}{1-\rho_t S} \left(  \rho_t e^{-tau/\mu_v} + \rho_t t_d'(\theta_v) \right)
$$


# References

[^1]: Vermote, E. F. T. D., Tanré, D., Deuzé, J. L., Herman, M., Morcrette, J. J., & Kotchenova, S. Y. (2006). Second simulation of a satellite signal in the solar spectrum-vector (6SV). 6S User Guide Version, 3, 1-55.

[^2]: Kotchenova, S. Y., Vermote, E. F., Levy, R., & Lyapustin, A. (2008). Radiative transfer codes for atmospheric correction and aerosol retrieval: intercomparison study. Applied Optics, 47(13), 2215-2226.

